;(function () {
    tinymce.PluginManager.add('abstract_plugin', function(editor, url) {
      editor.ui.registry.addButton('abstract', {
        //   text: '生成文章摘要',
          icon: 'abstract',
          onAction: function() {
              const selectedText = editor.selection.getContent();
  
             
  
              const mindMapData = {
                  data: {
                      text: selectedText,
                  },
                  children: []
              };
  
              const mindMapContainerId = 'mindmap-container';
              const mindMapContainer = `<div id="${mindMapContainerId}" style=" height: 400px;"></div>`;
  
             
              editor.windowManager.open({
                  title: '文章摘要',
                  body: {
                      type: 'panel',
                      items: [
                          {
                              type: 'htmlpanel',
                              html: mindMapContainer,
                          },
                      ],
                  },
                  buttons: [
                      {
                          type: 'submit',
                          text: '保存',
                          subtype: 'primary',
                          onclick: function() {
                              const mindMapContainerElement = document.getElementById(mindMapContainerId);
                              const mindMapInstance = new MindMap({
                                  el: mindMapContainerElement,
                                  data: mindMapData,
                              });
                              const imgData = mindMapInstance.exportImage(); // 假设这是自定义方法
                              editor.insertContent(`<img src="${imgData}" />`);
                              editor.windowManager.close();
                          }
                      },
                      {
                          type: 'cancel',
                          text: '取消',
                          onclick: 'close'
                      }
                  ],
                  onOpen: function() {
                      const mindMapContainerElement = document.getElementById(mindMapContainerId);
                      const mindMapInstance = new MindMap({
                          el: mindMapContainerElement,
                          data: mindMapData,
                      });
                  }
              });
          }
      });
  });
  
  })()