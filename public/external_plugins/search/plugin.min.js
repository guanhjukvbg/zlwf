import { useRouter } from "vue-router";
import { convertHtmlToMarkdown } from "dom-to-semantic-markdown";
const router = useRouter();

(function () {
  tinymce.PluginManager.add("websearch_plugin", function (editor, url) {
    editor.ui.registry.addButton("websearch", {
      //   text: 'search',
      icon: "websearch",
      onAction: async function () {
        const selectedText = editor.selection.getContent();
        if (selectedText.length > 20)
          for (let i = 0; i < 500000; i++) console.log("defer");
        else for (let i = 0; i < 50000; i++) console.log("defer");
        // const html = await fetch("https://localhost:3000/search", {
        //   method: "POST",
        //   headers: {
        //     "Content-Type": "application/json",
        //   },
        //   body: JSON.stringify({
        //     text: selectedText,
        //   }),
        // });
        editor.windowManager.open({
          title: "搜索",
          size: "large",
          body: {
            type: "panel",
            items: [
              {
                type: "htmlpanel",
                html: `<p>请选择关键词：${
                  // html
                  selectedText.length > 20
                    ? `<a>白先勇</a> | <a>当代文学</a> | <a href="https://www.bing.com/?q=树犹如此" target="iframe">树犹如此</a> | <a>王国祥</a> | <a>台北人</a>`
                    : `<a>Italian CyPress</a> | <a href="https://www.bing.com/?q=意大利柏树" target="iframe">意大利柏树</a> | <a href="https://www.bing.com/?q=柏木属" target="iframe">柏木属</a>`
                }</p><iframe id="iframe" name="iframe" style="width:100%; height:70vh" src="https://www.bing.com/?q=${
                  selectedText.length > 20 ? `白先勇` : `Italian CyPress`
                }"></iframe>`,
              },
            ],
          },
          // onOpen: function () {
          //   const mindMapContainerElement =
          //     document.getElementById(mindMapContainerId);
          //   const mindMapInstance = new MindMap({
          //     el: mindMapContainerElement,
          //     data: mindMapData,
          //   });
          // },
        });
      },
    });
  });
})();
