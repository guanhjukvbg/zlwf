(function () {
  tinymce.PluginManager.add("template_plugin", function (editor, url) {
    editor.ui.registry.addButton("template", {
      text: "tpl",
      // icon: "template",
      onAction: function () {
        editor.windowManager.open({
          title: "常用模板",
          size: "small",
          body: {
            type: "panel",
            items: [
              {
                type: "selectbox",
                name: "choosydata",
                label: "",
                items: [
                  {
                    value: `
<div class="frame" style="padding: 8px;">
			<div class="frame-container" style="
				border-color: #e6e7e8;
				border-style: solid;
				border-width: 1px;
				box-sizing: border-box;
				padding: 14.5px 18.92px 14.5px;
				margin-left: auto;
				margin-right: auto;
				background-color:#fff;
				font-family: Georgia, Times, 'Times New Roman', '华文中宋', 'Simsun', Serif;
				display: flex;
				align-items: top;
				flex-direction: row;
				width: 100%;
				max-width: 970px;
				min-height: 90px;
				max-width: 210mm;
			">
				<div class="frame-doc-container" style="
					box-sizing: border-box;
					display: flex;
					flex-direction: column;
					justify-content: top;
					flex-grow: 1;
					word-break: break-word;
					word-wrap: break-word;
					-webkit-hyphens: auto;
					-moz-hyphens: auto;
					hyphens: auto;
					max-width: 100%;
				">
					<header class="frame-title-container" style="
						box-sizing: border-box;
						margin-bottom: 23.55px;
						padding: 0;
						color: rgba(0, 0, 0, 0.79);
					">
						<div class="frame-subtitle" style="
							text-transform: uppercase;
							line-height: 23.55px;
							letter-spacing: 0.1em;
							font-size: 13.625px;
							color: rgba(0, 0, 0, 0.39);
							display: block;
						">sub title</div>
						<div class="frame-title" style="
							font-weight: 500;
							line-height: 1.3;
							letter-spacing: 0.02em;
							font-size: 27.25px;
							display: block;
							margin-top: 11.675px;
						">Title</div>
					</header>
				</div>
				<aside class="frame-aside-container" style="
					line-height: 1.3;
					box-sizing: border-box;
					padding: 0 37.83px;
					display: flex;
					flex-direction: column;
				">
					<div class="frame-btn-container" style="
						box-sizing: border-box;
						padding: 0;
						color: rgba(0, 0, 0, 0.79);
					">
						<div style="height:23.55px;"></div>
						<a href="" target="_blank"><div style="
							font-weight: 400;
							text-align: center;
							text-transform: capitalize;
							text-decoration: none;
							display: block;
							font-size: 13.9px;
							color: #fff;
							white-space: nowrap;

							border: 0;
							padding: 0 7.8px;
							height: 34.75px;
							line-height: 34.75px;
							max-height: 34.75px;
							min-width: 173.15px;

							background-color: #206bc4;
							border-radius: 4px;
							box-shadow: 0 6px 12px rgba(134, 140, 150, 0.65);

							vertical-align: center;
						">Button</div></a>
					</div>
				</aside>
			</div>
		</div>`,
                    text: "分享链接",
                  },
                  {
                    value: `
<table cellpadding="0" cellspacing="0" align="center" style="width: 100%; border: 0px solid #000000; border-radius: 0px; border-collapse: collapse; border-style: hidden;  box-shadow: 0 0 0 0px #000000; background-color: #f8fafc; line-height: 0; font-size: 0;">
	<tbody>
		<tr>
			<td height="32px"></td>
			<td height="32px"></td>
			<td height="32px"></td>
		</tr>
		<tr>
			<td width="16px" style="width: 16px; min-width: 16px; max-width: 16px; overflow: hidden;"></td>
			<td>
				<table cellpadding="0" cellspacing="0" align="center" width="512px" style="border: 0px solid #000000; border-radius: 0px; border-collapse: collapse; border-style: hidden;  box-shadow: 0 0 0 0px #000000; overflow: hidden; color: rgb(30, 41, 59);">
					<tbody>
						<tr>
							<td width="512px" style="box-sizing: border-box;">
								<table cellpadding="0" cellspacing="0" align="center" width="512px" style="border: 0px solid #000000; border-radius: 0px; border-collapse: collapse; border-style: hidden;  box-shadow: 0 0 0 0px #000000; overflow: hidden; color: rgb(30, 41, 59);">
									<tbody>
										<tr>
											<td width="512px" height="28px" style='font-family:  -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", sans-serif;'>
												<header width="512px" height="28px" color="#8BCAE0" style="max-height: 28px;text-align: center; color: rgb(139, 202, 224); font-size: 20px; line-height: 28px; font-weight: 600; text-overflow: hidden;">
													<span style="font-family: false, -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif">Header</span>
												</header>
											</td>
										</tr>
										<tr>
											<td width="512px" height="32px"></td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
						<tr>
							<td width="512px" style="box-sizing: border-box; background-color: white;">
								<table cellpadding="0" cellspacing="0" align="center" width="512px" style="box-shadow: rgba(30, 41, 59, .04) 0 2px 4px 0; border: 1px solid rgba(98, 105, 118, .16); border-radius: 4px; overflow: hidden; margin: 0; color: rgb(30, 41, 59);">
									<tbody>
										<tr>
											<td width="30px" height="32px"></td>
											<td width="448px" height="32px"></td>
											<td width="30px" height="32px"></td>
										</tr>
										<tr>
											<td width="30px" style="width: 30px; min-width: 30px; max-width: 30px;"></td>
											<td width="448px">
												<table cellpadding="0" cellspacing="0" align="center" width="448px" style="border: 0px solid #000000; border-radius: 0px; border-collapse: collapse; border-style: hidden;  box-shadow: 0 0 0 0px #000000; margin: 0; color: rgb(30, 41, 59); font-family: Times, 'Times New Roman', '华文中宋', 'Simsun', Serif;">
													<tbody>
														<tr style="font-family: simsun, STSongti-SC-Regular;">
															<td width="448px" style="width: 448px; max-width: 448px; min-width: 448px;">
																<h2 width="448px" height="" color="#000"  colspan="1" rowspan="1" style="width: 448px; max-width: 448px; min-width: 448px; text-align: center; color: rgba(0, 0, 0, 0.39); letter-spacing: 0.1em; font-size: 13.625px; line-height: 23.55px; font-weight: 400; margin: 0;">
																	<span style="font-family: Times, 'Times New Roman', '华文中宋', 'Simsun', Serif;">sub title</span>
																</h2>
															</td>
														</tr>
														<tr>
															<td width="448px" height="11.675px"></td>
														</tr>
														<tr style="font-family: simsun, STSongti-SC-Regular;">
															<td width="448px" style="width: 448px; max-width: 448px; min-width: 448px;">
																<h1 width="448px" height="" color="#000"  colspan="1" rowspan="1" style="width: 448px; max-width: 448px; min-width: 448px; text-align: center; color: rgba(0, 0, 0, 0.79); letter-spacing: 0.02em; font-size: 27.25px; line-height: 1.3; font-weight: 500; margin: 0;">
																	<span style="font-family: Times, 'Times New Roman', '华文中宋', 'Simsun', Serif;">Title</span>
																</h1>
															</td>
														</tr>
														<tr>
															<td width="448px" height="23.55px"></td>
														</tr>
														<tr>
															<td width="448px" height="23.55px"></td>
														</tr>
														<tr style="font-family: simsun, STSongti-SC-Regular;">
															<td width="448px" style="width: 448px; max-width: 448px; min-width: 448px;">
																<p width="448px" colspan="1" rowspan="1" style="width: 448px; max-width: 448px; min-width: 448px; text-align: start; color: rgba(0, 0, 0, 0.6); letter-spacing: 0.02em; font-size: 15.7px; line-height: 1.5; font-weight: 400; text-decoration: none; margin: 0; font-family: Times, 'Times New Roman', '华文中宋', 'Simsun', Serif;">
																	Content
																</p>
															</td>
														</tr>
													</tbody>
												</table>
											</td>
											<td width="30px" style="width: 30px; min-width: 30px; max-width: 30px;"></td>
										</tr>
										<tr>
											<td width="30px" height="32px"></td>
											<td width="448px" height="32px"></td>
											<td width="30px" height="32px"></td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
						<tr>
							<td>
								<table cellpadding="0" cellspacing="0" align="center" width="512px" style="border: 0px solid #000000; border-radius: 0px; border-collapse: collapse; border-style: hidden;  box-shadow: 0 0 0 0px #000000; overflow: hidden; color: rgb(30, 41, 59);">
									<tbody>
										<tr>
											<td height="16px"></td>
											<td height="16px"></td>
											<td height="16px"></td>
										</tr>
										<tr>
											<td width="8px"></td>
											<td width="496px">
												<p width="496px" colspan="1" rowspan="1" style="font-family: Times, 'Times New Roman', '华文中宋', 'Simsun', Serif; width: 496px; max-width: 496px; min-width: 496px; text-align: start; color: #626976; letter-spacing: 0; font-size: 12px; line-height: 16px; font-weight: normal; text-decoration: none; margin: 0;">
                          postscript
                        </p>
											</td>
											<td width="8px"></td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
					</tbody>
				</table>
			</td>
			<td width="16px" style="width: 16px; min-width: 16px; max-width: 16px; overflow: hidden;"></td>
		</tr>
		<tr>
			<td height="32px"></td>
			<td height="32px"></td>
			<td height="32px"></td>
		</tr>
	</tbody>
</table>`,
                    text: "email信纸",
                  },
                  { value: "<p>模板三</p>", text: "图片题头" },
                  { value: "<p>模板四</p>", text: "画廊" },
                  { value: "<p>模板五</p>", text: "两列图像" },
                  { value: "<p>模板六</p>", text: "图像与注解" },
                  { value: "<p>模板七</p>", text: "更多..." },
                ],
              },
            ],
          },
          buttons: [
            {
              type: "cancel",
              name: "cancel",
              text: "取消",
              enabled: true,
            },
            {
              type: "custom",
              name: "lastpage",
              text: "使用",
              enabled: true,
            },
          ],
          initialData: {
            choosydata: "",
          },
          onAction: (dialogApi, details) => {
            const data = dialogApi.getData();

            editor.insertContent(data.choosydata);

            dialogApi.close();
          },
        });
      },
    });
  });
})();
